<html>
  <head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-BVWPM1RL4F"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'G-BVWPM1RL4F');
    </script>
    <style>
      body { margin:0; padding:0; }
      iframe { position: absolute; height: 100%; width: 100%; }
    </style>
    <title>Tropical Tower Wars Academy</title>
    <link rel="icon" type="image/x-icon" href="https://i.imgur.com/klv5EHr.png">
  </head>
  <body>
    <iframe id="myIframe" src="" frameborder="0"></iframe>

    <script>
      // Get parameters from the URL of the parent page (GitHub Pages)
      function getQueryParams() {
        const urlParams = new URLSearchParams(window.location.search);
        let paramString = '';

        // Iterate over all parameters to build query string
        urlParams.forEach((value, key) => {
          if (paramString === '') {
            paramString += `${key}=${value}`;
          } else {
            paramString += `&${key}=${value}`;
          }
        });

        return paramString;
      }

      // Dynamically set iframe source with parameters - exec
      const iframe = document.getElementById('myIframe');
      const baseUrl = 'https://script.google.com/macros/s/AKfycbxtqhLxlSwJ004maiERjorkvJqaY8uZyflrvpYlimP6gmtgbcRhfNFUfIoj0yIR2uNjyA/exec';

      // If parameters exist, append them to the iframe URL
      const params = getQueryParams();
      iframe.src = params ? `${baseUrl}?${params}` : baseUrl;

      window.addEventListener('message', (event) => {
        console.log(event.data);
        document.title = event.data;
      });
    </script>
  </body>
</html>
